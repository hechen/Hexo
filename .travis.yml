# æŒ‡å®šè¯­è¨€ç¯å¢ƒ
language: node_js

# æŒ‡å®šéœ€è¦sudoæƒé™
sudo: required

# æŒ‡å®šnode_jsç‰ˆæœ¬ï¼Œç›®å‰æŒ‡å®šå’Œè‡ªå·±æœ¬æœºçš„ç‰ˆæœ¬å·ä¸€è‡´
node_js: 
  - 10.12.0

# This caches $HOME/.npm or node_modules, depending on the repositoryâ€™s structure.
cache: npm

before_install:
  - npm install
  - npm install -g hexo

# ç¡®ä¿å®‰è£…æ‰€æœ‰ Hexo æ‰€éœ€è¦çš„åŠŸèƒ½æ’ä»¶
install:
  - npm install hexo-generator-index --save
  - npm install hexo-generator-archive --save
  - npm install hexo-generator-category --save
  - npm install hexo-generator-tag --save
  - npm install hexo-server --save
  - npm install hexo-deployer-git --save

# æ‰§è¡Œæ¸…ç¼“å­˜ï¼Œç”Ÿæˆç½‘é¡µæ“ä½œ
script:
  - hexo clean
  - hexo generate

# è®¾ç½®gitæäº¤åï¼Œé‚®ç®±ï¼›æ›¿æ¢çœŸå®tokenåˆ°_config.ymlæ–‡ä»¶ï¼Œæœ€ådepoyéƒ¨ç½²
after_script:
  - git config user.name "chen"
  - git config user.email "hechen.dream@gmail.com"
  # æ›¿æ¢åŒç›®å½•ä¸‹çš„_config.ymlæ–‡ä»¶ä¸­gh_tokenå­—ç¬¦ä¸²ä¸ºtravisåå°åˆšæ‰é…ç½®çš„å˜é‡ï¼Œæ³¨æ„æ­¤å¤„sedå‘½ä»¤ç”¨äº†åŒå¼•å·ã€‚å•å¼•å·æ— æ•ˆï¼
  - sed -i "s/gh_token/${GH_TOKEN}/g" ./_config.yml
  - hexo deploy
  
  
  
notifications:
  slack: 
    channels:
      - chensworkspace:0iUM9QJqC1dzq27bJ9Fw87pn
    on_success: change 
    on_failure: always
  template:
      - "ğŸ‰ğŸ‰ğŸ‰ Blog Deploy Done! %{repository_slug} (%{commit}) : %{message}, Result: ${result} "
      - "Build details: %{build_url}"
